<!DOCTYPE html>
<html lang="en">
    <!-- head -->
        <%- include('../layout/head.ejs') %>
    <!-- body -->
        <body>
        <!-- Navigation-->
            <%- include('../layout/navBar.ejs') %>
        <!-- Header-->
            <header class="masthead" style="background-image: url('<%= posts.postImage %>')">
                <div class="container position-relative px-4 px-lg-5">
                    <div class="row gx-4 gx-lg-5 justify-content-center">
                        <div class="col-md-10 col-lg-8 col-xl-7">
                            <div class="site-heading">
                                <h5><%= posts.title %></h5>
                                <p>
                                    PostÃ© par
                                    <a href="/users/<%= posts.userId._id %>" style="color: white;"><%= posts.userId.username %></a>
                                    <%= posts.postDate.toDateString() %>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </header>
        <!-- Main Content-->
        <div class="container px-4 px-lg-5">
             <!-- Post Content-->
               <article class="container px-4 px-lg-5 text-break">
                    <%- posts.message %>
                </article>
            <!-- Send a new comment -->
                <div class="container px-4 px-lg-5">
                    <% if(!loggedIn) {%>
                        <p class="text-custom-color text-center" style="color: red">Connectez-vous pour laisser un commentaire</p>
                    <% }%>
                    <h6>Laisser un commentaire</h6>
                    <form action="/posts/<%= posts._id %>/comments/new" method="POST">
                        <div class="form-group mb-4">
                            <textarea name="body" class="form-control w-100" rows="5"></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">Envoyer</button>
                    </form>
                </div>
            <!-- Display the Comments -->
                <div class="container px-4 px-lg-5 my-5">
                    <h6>Commentaires</h6>
                    <ul class="list-group mb-3">
                        <% for(var i = 0; i < posts.comments.length; i++) { %>
                            <li class="list-group-item">
                                <p>
                                    <a href="/users/<%= posts.comments[i].authorId %>" class="text-decoration-underline"><%= posts.comments[i].author %></a>
                                    <br>
                                    <%= posts.comments[i].body %>
                                </p>  
                                <span class="text-muted fs-6"><%= posts.comments[i].dateOfComment.toLocaleDateString() %></span>
                            </li>
                        <% } %>
                    </ul>
                </div>
        </div>
        <!-- Footer-->
            <%- include('../layout/footer.ejs') %>
        <!-- Bootstrap core JS-->
        <!-- Core theme JS-->
            <%- include('../layout/script.ejs') %>
        </body>
</html>
